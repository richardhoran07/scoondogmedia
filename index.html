<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SCOONDOG156 MULTIMEDIA WAREHOUSE</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=UnifrakturCook:wght@700&display=swap" rel="stylesheet">
  <style>
    body { margin:0; background:black; overflow:hidden; color:#ffd7d7; font-family:'Inter',sans-serif; }
    #bg-canvas { position:fixed; inset:0; width:100%; height:100%; z-index:0; }
    #sphere-container { width:320px; height:320px; margin:1rem auto; z-index:2; position:relative; }
    #audio-controls { display:flex; justify-content:center; align-items:center; gap:.5rem; margin-bottom:1rem; font-family:'UnifrakturCook',cursive; color:#d61a1a; }
    #audio-controls select, #audio-controls button { background:black; color:#d61a1a; border:2px solid #d61a1a; padding:.2rem .4rem; font-family:inherit; }
    section.panels { display:flex; justify-content:center; gap:1rem; margin:2rem auto; }
    .panel a { font-family:'UnifrakturCook',cursive; color:#d61a1a; font-size:1.6rem; border:2px double #d61a1a; padding:.5rem 1rem; text-decoration:none; box-shadow:0 0 12px rgba(214,26,26,.6); }
    footer { text-align:center; color:#d61a1a; margin-top:1rem; }
  </style>
</head>
<body>
  <canvas id="bg-canvas"></canvas>
  <main class="wrap">
    <div id="sphere-container"></div>

    <div id="audio-controls">
      <select id="track-select">
        <option value="sounds/background.mp3">background.mp3</option>
        <option value="sounds/background2.mp3">background2.mp3</option>
        <option value="sounds/background3.mp3">background3.mp3</option>
      </select>
      <button id="play-btn">▶ Play</button>
    </div>

    <section class="panels">
      <div class="panel"><a href="words/">Words</a></div>
      <div class="panel"><a href="images/">Images</a></div>
      <div class="panel"><a href="sounds/">Sounds</a></div>
    </section>

    <footer>© <span id="year"></span> SCOONDOG156</footer>
  </main>
  <audio id="bg-audio" loop></audio>

  <script type="importmap">
  { "imports": { "three": "https://cdn.jsdelivr.net/npm/three@0.161.0/build/three.module.js" } }
  </script>

  <script type="module">
  import * as THREE from "three";
  import "./common.js";

  const cont=document.getElementById("sphere-container");
  const scene=new THREE.Scene();
  const camera=new THREE.PerspectiveCamera(45,1,0.1,1000);
  camera.position.z=3;
  const renderer=new THREE.WebGLRenderer({antialias:true,alpha:true});
  renderer.setSize(cont.clientWidth,cont.clientHeight);
  cont.appendChild(renderer.domElement);

  // Orbiting lights
  const lights=[
    new THREE.PointLight(0xff0000,2),
    new THREE.PointLight(0xffffff,1.6),
    new THREE.PointLight(0x00aaff,1.8),
    new THREE.PointLight(0xffdd00,1.8),
    new THREE.PointLight(0xff00ff,2),
    new THREE.PointLight(0x00ff55,1.8),
    new THREE.PointLight(0x5555ff,1.8)
  ];
  lights.forEach(l=>scene.add(l));

  // Simple procedural env (dark gradient)
  const canvas = document.createElement("canvas");
  canvas.width = 256; canvas.height = 256;
  const ctx = canvas.getContext("2d");
  const grad = ctx.createRadialGradient(128,128,20,128,128,128);
  grad.addColorStop(0,"#333");
  grad.addColorStop(1,"#000");
  ctx.fillStyle=grad; ctx.fillRect(0,0,256,256);
  const envMap=new THREE.CanvasTexture(canvas);
  envMap.mapping=THREE.EquirectangularReflectionMapping;
  envMap.needsUpdate=true;

  // --- FUSHIGI ORB (ShaderMaterial) ---
  const uniforms={
    time:{value:0},
    envMap:{value:envMap}
  };

  const vertexShader=`
    varying vec3 vNormal;
    varying vec3 vReflect;
    uniform float time;
    void main(){
      vec3 newPosition=position + normal*0.1*sin(time+position.y*5.0);
      vNormal=normalize(normalMatrix*normal);
      vec4 worldPosition=modelMatrix*vec4(newPosition,1.0);
      vec3 I=worldPosition.xyz-cameraPosition;
      vReflect=reflect(I,normalize(normalMatrix*normal));
      gl_Position=projectionMatrix*modelViewMatrix*vec4(newPosition,1.0);
    }
  `;

  const fragmentShader=`
    uniform sampler2D envMap;
    uniform float time;
    varying vec3 vNormal;
    varying vec3 vReflect;
    void main(){
      vec2 uv=normalize(vReflect).xy*0.5+0.5;
      vec3 envColor=texture2D(envMap,uv).rgb;
      float shine=pow(1.0-dot(vNormal,vec3(0.0,0.0,1.0)),8.0);
      gl_FragColor=vec4(envColor+shine,1.0);
    }
  `;

  const mat=new THREE.ShaderMaterial({
    uniforms:uniforms,
    vertexShader:vertexShader,
    fragmentShader:fragmentShader
  });

  const sphere=new THREE.Mesh(new THREE.SphereGeometry(1,128,128),mat);
  scene.add(sphere);

  function animate(){
    requestAnimationFrame(animate);
    const t=performance.now()*0.001;
    uniforms.time.value=t;

    // orbit lights
    lights.forEach((l,i)=>{
      const r=3+i*0.2, s=0.4+i*0.15;
      l.position.set(Math.cos(t*s+i)*r, Math.sin(t*s+i*0.7)*r, Math.sin(t*s*0.5+i)*r);
    });

    renderer.render(scene,camera);
  }
  animate();
  </script>
</body>
</html>
